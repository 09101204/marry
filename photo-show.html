<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>婚礼纪</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" type="text/css" href="css/base.css">
    <link rel="stylesheet" type="text/css" href="css/global.css">
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/module.css">
    <link rel="stylesheet" type="text/css" href="css/status.css">
    <link rel="stylesheet" type="text/css" href="css/jquery.fancybox.css">

    <script src="js/sea-modules/seajs/1.3.1/sea.js" type="text/javascript"></script>
    <script src="http://libs.baidu.com/jquery/1.9.0/jquery.min.js" type="text/javascript"></script>
    <script src="js/dist/sly.min.js" type="text/javascript"></script>
    <script src="js/dist/jquery.fancybox.pack.js" type="text/javascript"></script>
    <!--[if lt IE 9]>
    <script type="text/javascript" src="js/dist/html5shiv.js"></script>
    <![endif]-->
</head>
<body class="photo-show">
<header class="top-tool">
    <div class="sl-hvalign">
        <div class="sl-hvalign-cnt">
            <div class="sl-hvalign-cnt-inner">
                <div class="ui-slip">
                    <div class="ui-slip-inner">
                        <i class="small-arrow"></i>
                        <a class="back" href="/">返回</a>
                    </div>
                </div>
                <div class="ui-slip">
                    <div class="ui-slip-inner">
                        <h3>返画卷标题文字</h3>
                    </div>
                </div>
                <div class="ui-slip">
                    <div class="ui-slip-inner">
                        <h3>分享到：</h3>
                    </div>
                </div>
                <div class="ui-share-btn-list">
                    <a href="#" target="_blank" class="sina">sina</a>
                    <a href="#" target="_blank" class="qzone">qq</a>
                    <a href="#" target="_blank" class="tt">t</a>
                </div>
            </div>
        </div>
    </div> <!-- .sl-hvalign -->
    <div class="ui-top-nav" id="photo-user-panel">
        <div  class="user-panel">
            <div class="user-active">
                <span class="arrow">&gt;</span>
                                <span class="avatar">
                                    <img src="assets/test/avatar.jpg">
                                </span>
                <div class="option">
                    <ul>
                        <li class="option-item"><a href="/">创建画卷</a></li>
                        <li class="option-item"><a href="/">个人主页</a></li>
                        <li class="option-item"><a href="/">编辑资料</a></li>
                        <li class="option-item"><a href="/">退出</a></li>
                    </ul>
                </div>
            </div>
            <span class="notice notice-active" id="noticeTrigger"> 1 </span>
        </div>
    </div>
</header>
<article class="viewer" id="viewer">
    <div class="viewport-wrapper" id="viewer-wrapper">
        <div id="viewPrev" class="viewArrow viewArrow-left">
            <div class="prev">&lt; </div>
        </div>
        <div class="viewArrow viewArrow-right">
            <div class="next">&gt;</div>
        </div>
        <div id="horizontal">
            <div class="sly" id="slide">
                <ul class="node-list" id="slideBody">
                    <li class="cover fancybox"> <div class="cover-dot-top">”</div> <div class="cover-content" id="cover"> <div class="sl-hvalign"> <div class="sl-hvalign-cnt"> <div class="sl-hvalign-cnt-inner"> 字数限制在四十五字以内的一段话，用于介绍自己创建的画卷的。</div> </div> </div> </div> <div class="cover-dot-bottom">”</div> </li>
                    <li>
                        <a class="fancybox" rel="gallery1" href="assets/test/show.jpg">
                            <img src="assets/test/show.jpg" alt="xxd"/>
                        </a>
                    </li>
                    <li>
                        <a class="fancybox" rel="gallery1" href="assets/test/1.jpg">
                            <img src="assets/test/1.jpg" alt="xxd"/>
                        </a>
                    </li>
                    <li>
                        <a class="fancybox" rel="gallery1" href="assets/test/banner1.jpg">
                            <img class="lazyload" src="assets/test/banner1.jpg" alt="xxd"/>
                        </a>
                    </li>
                    <li>
                        <a class="fancybox" rel="gallery1" href="assets/test/template.jpg">
                            <img class="lazyload" src="assets/test/template.jpg" alt="xxd"/>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</article>
<footer id="footFool" class="foot-tol">
    <div class="sl-hvalign">
        <div class="sl-hvalign-cnt">
            <div class="sl-hvalign-cnt-inner">
                <div class="ui-slip prevPage">
                    <div class="ui-slip-inner">
                        <a  href="javascript:;"><span class="prev-page">往左</span></a>
                    </div>
                </div>
                <div class="scrollbar-panel">
                    <div class="scrollbar"> <div class="handle"></div> </div>
                </div>
                <div class="ui-slip nextPage">
                    <div class="ui-slip-inner">
                        <a  href="javascript:;"><span class="next-page">往右</span></a>
                    </div>
                </div>
                <div class="ui-share-btn-list">
                    <div class="counter">
                        <span id="commentBack" class="comments">11</span>
                        <span class="fav">11</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<div id="commentPanel" class="ui-dialog-container ">
    <div id="comments-list" class="ui-comment-list">
            <ul></ul>
    </div>
    <div class="comment-input">
        <form class="ui-comment-form">
            <input type="text" id="commentInput" class="ui-comment-input" onclick="this.value=''"  value="写些评论吧"/>
            <div class="ui-btn ui-btn-green middle comment-btn" >
                <input type="submit" id="commentBtn" class="ui-btn-text" value="发送">
            </div>
        </form>
    </div>
</div>

<script>
    var data={ "id":41,"collection_count":0,"introduction":"\u653e\u70df\u82b1\u5e7f\u544a\u8d39\u798f\u9ec4\u82b1\u5c97\u7535\u89c6\u7f51\u591a\u591a\u5c11\u5c11\u4e1c\u65b9\u5e7f\u573a\u798f\u5730\u65b9\u54e5\u54e5\u53d1\u73b0\u7684\u53cd\u53cd\u590d\u590d\u98ce\u683c","share_count":0,"title":"\u82b3\u534e\u5e7f\u544a\u8d39","created_at":"2013-04-28T07:33:18Z","ending":"image_montage/242MM.jpg","discussion_count":2,"collect_count":1,"collected":0,"user":{"nick":"\u5e2d\u5929\u5e55\u5730","avatar":"avatar/72013-04-26T19:46:05+08:00+200.jpg","id":7},"photos":[{"created_at":"2013-04-28T07:33:16Z","height":1240.0,"id":238,"montage_id":41,"path":"image_montage/238.jpg","title":"\u5171\u548c\u56fd\u798f","updated_at":"2013-04-28T07:33:18Z","width":930.0},{"created_at":"2013-04-28T07:33:16Z","height":1240.0,"id":239,"montage_id":41,"path":"image_montage/239.jpg","title":"","updated_at":"2013-04-28T07:33:18Z","width":930.0},{"created_at":"2013-04-28T07:33:16Z","height":1240.0,"id":240,"montage_id":41,"path":"image_montage/240.jpg","title":"","updated_at":"2013-04-28T07:33:18Z","width":930.0},{"created_at":"2013-04-28T07:33:17Z","height":930.0,"id":241,"montage_id":41,"path":"image_montage/241.jpg","title":"","updated_at":"2013-04-28T07:33:18Z","width":1240.0},{"created_at":"2013-04-28T07:33:17Z","height":930.0,"id":242,"montage_id":41,"path":"image_montage/242.jpg","title":"","updated_at":"2013-04-28T07:33:18Z","width":1240.0}],"x":1}
</script>

<script type="text/javascript">
    var length=data.photos.length,$ul=$("#slideBody"),output='';;
    (function(){
        var htmlTem='<li><a class="fancybox" rel="gallery1" href="http://marrymemo.com:3000/{pic}"><img class="lazyload" src="http://marrymemo.com:3000/{path}"></a></li>';
        for(var i=0;i<length;i++){
            output+=htmlTem.replace('{pic}',data.photos[i].path).replace('{path}',data.photos[i].path);
        }
        $ul.append(output+' <li class="cover fancybox"> <div class="cover-dot-top"></div> <div class="cover-content"> <div class="sl-hvalign"> <div class="sl-hvalign-cnt"> <div class="sl-hvalign-cnt-inner"> 最后一页啦 </div> </div> </div> </div> </div> <div class="cover-dot-bottom">”</div></li>');
        console.log("sly-------------end");
    }());

    //初始化
    $(document).ready(function() {
        $(".fancybox").fancybox({
            prevEffect		: 'none',
            nextEffect		: 'none',
            closeBtn		: true,
            padding:0,
            autoSize:true,
            nextBtn:true,
            helpers : {
                overlay : {
                    css : {
                        'background' : 'rgba(0, 0, 0, 0.7)'
                    }
                }
            }

        });
//        $("#commentsSly").sly({
//            horizontal:0,
//            itemNav: "basic",
//            scrollBy: 1,
//            speed: 500,
//            dynamicHandle: 1,
//            dragHandle:    1,    // Whether the scrollbar handle should be draggable.
//            scrollBar:$(".ui-scrollbar-vertical")
//        });

    });
    // Call Sly on frame
    var $frame=new Sly("#slide",{
        horizontal: 1,
        itemNav: 'basic',
        smart: 1,
        activateOn: 'click',
        startAt: 1,
        scrollBy: 1,
        activatePageOn: 'click',
        speed: 300,
        elasticBounds: 1,
        dragHandle: 1,
        clickBar: 1,

        // Buttons
        scrollBar: $('.scrollbar'),
        prev: $('.prev'),
        next: $('.next'),
        prevPage: $('.prev-page'),
        nextPage: $('.nextPage')
    });
    $frame.init();

    seajs.config({
        alias: {
            "$": "gallery/jquery.js"
        }
    });
    seajs.use(['marry/application','arale/dialog/1.0.1/dialog','$'], function(App,Dialog,$) {
        $(".lazyload").scrollLoading({
            callback:function(){
//                alert("fuck");
                $(this).on("load complete",$(this).parent().parent().width($(this).width()));
                $frame.reload();
            }
        });
        var feedBack=new Dialog({
            trigger: '#commentBack',
            height: '520px',
            width:'480px',
            effect: 'fade',
            content: '#commentPanel'

        });
        var comment=new App.Comment({
            element:'#comments-list'
        });
        comment.get(41,'#comments-list ul');

        $("#commentBtn").click(function(){
            comment.post(41,7,"#commentInput",function(){
                alert("good");
            })
        });
        feedBack.after('show',function(){
            $("#commentPanel").show();

        });
    });

</script>
</body>
</html>